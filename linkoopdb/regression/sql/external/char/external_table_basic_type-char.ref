SQLCli Release 0.0.45
SQL> start char/external_table_basic_type-char.sql
SQL> loaddriver E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar com.datapps.linkoopdb.jdbc.JdbcDriver
driver file [E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar] does not exist.
SQL> connect admin/123456@jdbc:linkoopdb:tcp://192.168.1.73:9105/ldb
Database connected.
SQL> set echo on
SQL> 
SQL> 
SQL> --    Description: char边界值测试,char的范围64000
   > --    Date:         2020-05-28
   > --    Author:       丁婷
   > --    hdfs external csv格式
   > 
   > --char边界值测试,char的范围64000
   > -- 删除t_external_hdfs_csv_char_001表
SQL> drop table if exists t_external_hdfs_csv_char_001;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_001，测试创建长度大于64000,创建报错
SQL> create external table t_external_hdfs_csv_char_001(
   > a1 char(64001)
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_002表
SQL> drop table if exists t_external_hdfs_csv_char_002;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_002，测试长度为64000，数据大小为100000
SQL> create external table t_external_hdfs_csv_char_002(
   > a1 char(10) 
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_002的数据,实际返回100000
SQL> select * from t_external_hdfs_csv_char_002;
+------------+
| A1         |
+------------+
| KOWjsLYXdn |
+------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_003表
SQL> drop table if exists t_external_hdfs_csv_char_003;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_003，测试值带双引号,"asdf",char默认长度是1
SQL> create external table t_external_hdfs_csv_char_003(
   > a1 char(20)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_003的数据，实际返回asdf
SQL> select * from t_external_hdfs_csv_char_003;
+----------------------+
| A1                   |
+----------------------+
| asdf                 |
+----------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_004表
SQL> drop table if exists t_external_hdfs_csv_char_004;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_004，测试值为单引号，值为'asdf'
SQL> create external table t_external_hdfs_csv_char_004(
   > a1 char(30) 
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_004.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_004的数据,实际返回'asdf'
SQL> select * from t_external_hdfs_csv_char_004;
+--------------------------------+
| A1                             |
+--------------------------------+
| 'asdf'                         |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_005表
SQL> drop table if exists t_external_hdfs_csv_char_005;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_005，测试值不带引号，为asdf
SQL> create external table t_external_hdfs_csv_char_005(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_005的数据,实际返回asdf
SQL> select * from t_external_hdfs_csv_char_005;
+--------------------------------+
| A1                             |
+--------------------------------+
| asdf                           |
+--------------------------------+
1 row selected.
SQL> 
SQL>   
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_007表
SQL> drop table if exists t_external_hdfs_csv_char_007;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_007，测试varchar中文字符，值为'你好'
SQL> create external table t_external_hdfs_csv_char_007(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_007的数据,实际返回你好
SQL> select * from t_external_hdfs_csv_char_007;
+----------------------------------+
| A1                               |
+----------------------------------+
| 你好                             |
+----------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_008表
SQL> drop table if exists t_external_hdfs_csv_char_008;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_008，测试varchar中英文字符，值为'你好asdf'
SQL> create external table t_external_hdfs_csv_char_008(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_008的数据，返回值为你好asdf
SQL> select * from t_external_hdfs_csv_char_008;
+----------------------------------+
| A1                               |
+----------------------------------+
| 你好asdf                         |
+----------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_009表
SQL> drop table if exists t_external_hdfs_csv_char_009;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_009，测试varchar英文特殊字符，值为'#$%^'
SQL> create external table t_external_hdfs_csv_char_009(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_009的数据，实际返回为#$%^
SQL> select * from t_external_hdfs_csv_char_009;
+--------------------------------+
| A1                             |
+--------------------------------+
| #$%^                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_010表
SQL> drop table if exists t_external_hdfs_csv_char_010;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_010，测试varchar中文特殊字符，值为'@#￥%……'
SQL> create external table t_external_hdfs_csv_char_010(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_010的数据，实际返回为@#￥%……
SQL> select * from t_external_hdfs_csv_char_010;
+---------------------------------+
| A1                              |
+---------------------------------+
| @#￥%……                         |
+---------------------------------+
1 row selected.
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_011表
SQL> drop table if exists t_external_hdfs_csv_char_011;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_011，测试varchar为数字，值为'123456789'
SQL> create external table t_external_hdfs_csv_char_011(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_007.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_011的数据，实际返回为'123456789'
SQL> select * from t_external_hdfs_csv_char_011;
+--------------------------------+
| A1                             |
+--------------------------------+
| '123456789'                    |
+--------------------------------+
1 row selected.
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_012，测试date类型，时间为2020-01-01
SQL> create external table t_external_hdfs_csv_char_012(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_date.csv')
   > format 'csv' (delimiter ',');
java.sql.SQLSyntaxErrorException: object name already exists: T_EXTERNAL_HDFS_CSV_CHAR_012 in statement [create external table t_external_hdfs_csv_char_012(
a1 char(30)  
)location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_date.csv')
format 'csv' (delimiter ',')]
SQL>   
SQL> --查询t_external_hdfs_csv_char_012的数据，实际返回为2020-05-08
SQL> select * from t_external_hdfs_csv_char_012;
+--------------------------------+
| A1                             |
+--------------------------------+
| 2020-05-08                     |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_013表
SQL> drop table if exists t_external_hdfs_csv_char_013;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_013，测试timestamp类型,时间为2020-01-01 00:00:01
SQL> create external table t_external_hdfs_csv_char_013(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_timestamp.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_013的数据，实际返回 为2020-05-08 12:19:01
SQL> select * from t_external_hdfs_csv_char_013;
+--------------------------------+
| A1                             |
+--------------------------------+
| 2020-05-08 12:19:01            |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_015表
SQL> drop table if exists t_external_hdfs_csv_char_015;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_015，测试空值
SQL> create external table t_external_hdfs_csv_char_015(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_015的数据，实际返回为''
SQL> select * from t_external_hdfs_csv_char_015;
+--------------------------------+
| A1                             |
+--------------------------------+
| ''                             |
+--------------------------------+
1 row selected.
SQL>  
SQL>  
SQL> -- 删除t_external_hdfs_csv_char_016表
SQL> drop table if exists t_external_hdfs_csv_char_016;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_016，测试空格 
SQL> create external table t_external_hdfs_csv_char_016(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_016的数据,实际返回为' '
SQL> select * from t_external_hdfs_csv_char_016;
+--------------------------------+
| A1                             |
+--------------------------------+
| ' '                            |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_017表
SQL> drop table if exists t_external_hdfs_csv_char_017;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_017，测试null 
SQL> create external table t_external_hdfs_csv_char_017(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_017的数据，实际返回为null
SQL> select * from t_external_hdfs_csv_char_017;
+--------------------------------+
| A1                             |
+--------------------------------+
| null                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_018表
SQL> drop table if exists t_external_hdfs_csv_char_018;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_018，测试NULL  
SQL> create external table t_external_hdfs_csv_char_018(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_018的数据，实际返回为NULL
SQL> select * from t_external_hdfs_csv_char_018;
+--------------------------------+
| A1                             |
+--------------------------------+
| NULL                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_019表
SQL> drop table if exists t_external_hdfs_csv_char_019;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_019，测试int类型，值为1147483647
SQL> create external table t_external_hdfs_csv_char_019(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_008.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_019的数据,实际返回为1147483647
SQL> select * from t_external_hdfs_csv_char_019;
+--------------------------------+
| A1                             |
+--------------------------------+
| 1147483647                     |
+--------------------------------+
1 row selected.
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_020表
SQL> drop table if exists t_external_hdfs_csv_char_020;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_020，测试double类型，值为 1147483647.2
SQL> create external table t_external_hdfs_csv_char_020(
   > a1 char(30) 
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_009.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_020的数据,实际返回为 1147483647.2
SQL> select * from t_external_hdfs_csv_char_020;
+--------------------------------+
| A1                             |
+--------------------------------+
| 1147483647.2                   |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_021表
SQL> drop table if exists t_external_hdfs_csv_char_021;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_021，测试boolean类型，值为false
SQL> create external table t_external_hdfs_csv_char_021(
   > a1 char(30)   
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_021的数据,实际返回为false
SQL> select * from t_external_hdfs_csv_char_021;
+--------------------------------+
| A1                             |
+--------------------------------+
| false                          |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_char_022表
SQL> drop table if exists t_external_hdfs_csv_char_022;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_char_022，测试boolean类型，值为true
SQL> create external table t_external_hdfs_csv_char_022(
   > a1 char(30)  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_char_022的数据,实际返回为true
SQL> select * from t_external_hdfs_csv_char_022;
+--------------------------------+
| A1                             |
+--------------------------------+
| true                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- ldbdist csv 
   > --char边界值测试,char的范围64000
   > -- 删除t_external_ldbdist_csv_char_001表
SQL> drop table if exists t_external_ldbdist_csv_char_001;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_001，测试创建长度大于64000,创建报错
SQL> create external table t_external_ldbdist_csv_char_001(
   > a1 char(64001)
   > )location('ldbdist://node74:54321/csv/varchar_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_002表
SQL> drop table if exists t_external_ldbdist_csv_char_002;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_002，测试长度为64000，数据大小为100000
SQL> create external table t_external_ldbdist_csv_char_002(
   > a1 char(10) 
   > )location('ldbdist://node74:54321/csv/varchar_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_002的数据,实际返回100000
SQL> select * from t_external_ldbdist_csv_char_002;
+------------+
| A1         |
+------------+
| KOWjsLYXdn |
+------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_003表
SQL> drop table if exists t_external_ldbdist_csv_char_003;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_003，测试值带双引号,"asdf",char默认长度是1
SQL> create external table t_external_ldbdist_csv_char_003(
   > a1 char(20)  
   > )location('ldbdist://node74:54321/csv/varchar_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_003的数据，实际返回asdf
SQL> select * from t_external_ldbdist_csv_char_003;
+----------------------+
| A1                   |
+----------------------+
| asdf                 |
+----------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_004表
SQL> drop table if exists t_external_ldbdist_csv_char_004;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_004，测试值为单引号，值为'asdf'
SQL> create external table t_external_ldbdist_csv_char_004(
   > a1 char(30) 
   > )location('ldbdist://node74:54321/csv/varchar_004.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_004的数据,实际返回'asdf'
SQL> select * from t_external_ldbdist_csv_char_004;
+--------------------------------+
| A1                             |
+--------------------------------+
| 'asdf'                         |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_005表
SQL> drop table if exists t_external_ldbdist_csv_char_005;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_005，测试值不带引号，为asdf
SQL> create external table t_external_ldbdist_csv_char_005(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/varchar_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_005的数据,实际返回asdf
SQL> select * from t_external_ldbdist_csv_char_005;
+--------------------------------+
| A1                             |
+--------------------------------+
| asdf                           |
+--------------------------------+
1 row selected.
SQL> 
SQL>   
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_007表
SQL> drop table if exists t_external_ldbdist_csv_char_007;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_007，测试varchar中文字符，值为'你好'
SQL> create external table t_external_ldbdist_csv_char_007(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_007的数据,实际返回你好
SQL> select * from t_external_ldbdist_csv_char_007;
+----------------------------------+
| A1                               |
+----------------------------------+
| 你好                             |
+----------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_008表
SQL> drop table if exists t_external_ldbdist_csv_char_008;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_008，测试varchar中英文字符，值为'你好asdf'
SQL> create external table t_external_ldbdist_csv_char_008(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_008的数据，返回值为你好asdf
SQL> select * from t_external_ldbdist_csv_char_008;
+----------------------------------+
| A1                               |
+----------------------------------+
| 你好asdf                         |
+----------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_009表
SQL> drop table if exists t_external_ldbdist_csv_char_009;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_009，测试varchar英文特殊字符，值为'#$%^'
SQL> create external table t_external_ldbdist_csv_char_009(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_009的数据，实际返回为#$%^
SQL> select * from t_external_ldbdist_csv_char_009;
+--------------------------------+
| A1                             |
+--------------------------------+
| #$%^                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_010表
SQL> drop table if exists t_external_ldbdist_csv_char_010;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_010，测试varchar中文特殊字符，值为'@#￥%……'
SQL> create external table t_external_ldbdist_csv_char_010(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_010的数据，实际返回为@#￥%……
SQL> select * from t_external_ldbdist_csv_char_010;
+---------------------------------+
| A1                              |
+---------------------------------+
| @#￥%……                         |
+---------------------------------+
1 row selected.
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_011表
SQL> drop table if exists t_external_ldbdist_csv_char_011;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_011，测试varchar为数字，值为'123456789'
SQL> create external table t_external_ldbdist_csv_char_011(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/varchar_007.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_011的数据，实际返回为'123456789'
SQL> select * from t_external_ldbdist_csv_char_011;
+--------------------------------+
| A1                             |
+--------------------------------+
| '123456789'                    |
+--------------------------------+
1 row selected.
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_012，测试date类型，时间为2020-01-01
SQL> create external table t_external_ldbdist_csv_char_012(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/type_date.csv')
   > format 'csv' (delimiter ',');
java.sql.SQLSyntaxErrorException: object name already exists: T_EXTERNAL_LDBDIST_CSV_CHAR_012 in statement [create external table t_external_ldbdist_csv_char_012(
a1 char(30)  
)location('ldbdist://node74:54321/csv/type_date.csv')
format 'csv' (delimiter ',')]
SQL>   
SQL> --查询t_external_ldbdist_csv_char_012的数据，实际返回为2020-05-08
SQL> select * from t_external_ldbdist_csv_char_012;
+--------------------------------+
| A1                             |
+--------------------------------+
| 2020-05-08                     |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_013表
SQL> drop table if exists t_external_ldbdist_csv_char_013;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_013，测试timestamp类型,时间为2020-01-01 00:00:01
SQL> create external table t_external_ldbdist_csv_char_013(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/type_timestamp.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_013的数据，实际返回 为2020-05-08 12:19:01
SQL> select * from t_external_ldbdist_csv_char_013;
+--------------------------------+
| A1                             |
+--------------------------------+
| 2020-05-08 12:19:01            |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_015表
SQL> drop table if exists t_external_ldbdist_csv_char_015;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_015，测试空值
SQL> create external table t_external_ldbdist_csv_char_015(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_015的数据，实际返回为''
SQL> select * from t_external_ldbdist_csv_char_015;
+--------------------------------+
| A1                             |
+--------------------------------+
| ''                             |
+--------------------------------+
1 row selected.
SQL>  
SQL>  
SQL> -- 删除t_external_ldbdist_csv_char_016表
SQL> drop table if exists t_external_ldbdist_csv_char_016;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_016，测试空格 
SQL> create external table t_external_ldbdist_csv_char_016(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_016的数据,实际返回为' '
SQL> select * from t_external_ldbdist_csv_char_016;
+--------------------------------+
| A1                             |
+--------------------------------+
| ' '                            |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_017表
SQL> drop table if exists t_external_ldbdist_csv_char_017;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_017，测试null 
SQL> create external table t_external_ldbdist_csv_char_017(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_017的数据，实际返回为null
SQL> select * from t_external_ldbdist_csv_char_017;
+--------------------------------+
| A1                             |
+--------------------------------+
| null                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_018表
SQL> drop table if exists t_external_ldbdist_csv_char_018;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_018，测试NULL  
SQL> create external table t_external_ldbdist_csv_char_018(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_018的数据，实际返回为NULL
SQL> select * from t_external_ldbdist_csv_char_018;
+--------------------------------+
| A1                             |
+--------------------------------+
| NULL                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_019表
SQL> drop table if exists t_external_ldbdist_csv_char_019;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_019，测试int类型，值为1147483647
SQL> create external table t_external_ldbdist_csv_char_019(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/varchar_008.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_019的数据,实际返回为1147483647
SQL> select * from t_external_ldbdist_csv_char_019;
+--------------------------------+
| A1                             |
+--------------------------------+
| 1147483647                     |
+--------------------------------+
1 row selected.
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_020表
SQL> drop table if exists t_external_ldbdist_csv_char_020;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_020，测试double类型，值为 1147483647.2
SQL> create external table t_external_ldbdist_csv_char_020(
   > a1 char(30) 
   > )location('ldbdist://node74:54321/csv/varchar_009.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_020的数据,实际返回为 1147483647.2
SQL> select * from t_external_ldbdist_csv_char_020;
+--------------------------------+
| A1                             |
+--------------------------------+
| 1147483647.2                   |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_021表
SQL> drop table if exists t_external_ldbdist_csv_char_021;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_021，测试boolean类型，值为false
SQL> create external table t_external_ldbdist_csv_char_021(
   > a1 char(30)   
   > )location('ldbdist://node74:54321/csv/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_021的数据,实际返回为false
SQL> select * from t_external_ldbdist_csv_char_021;
+--------------------------------+
| A1                             |
+--------------------------------+
| false                          |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_char_022表
SQL> drop table if exists t_external_ldbdist_csv_char_022;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_char_022，测试boolean类型，值为true
SQL> create external table t_external_ldbdist_csv_char_022(
   > a1 char(30)  
   > )location('ldbdist://node74:54321/csv/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_char_022的数据,实际返回为true
SQL> select * from t_external_ldbdist_csv_char_022;
+--------------------------------+
| A1                             |
+--------------------------------+
| true                           |
+--------------------------------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- hdfs external parquet 
   > 
   > -- 删除表
SQL> drop table if exists t_external_hdfs_parquet_char_001;
0 rows affected
SQL> drop table if exists t_external_hdfs_parquet_char_002;
0 rows affected
SQL> drop table if exists t_external_hdfs_parquet_char_003;
0 rows affected
SQL> drop table if exists t_external_hdfs_parquet_char_004;
0 rows affected
SQL> 
SQL> -- 测试创建长度大于64000,创建报错
SQL> create external table t_external_hdfs_parquet_char_001(
   > a1 char(64001)
   > )location('hdfs://node73:8020/user/testdb73/external_file/type_parquet/char1')
   > FORMAT 'parquet';
0 rows affected
SQL> 
SQL> -- 测试长度为64000，数据大小为100000
SQL> create external table t_external_hdfs_parquet_char_002(
   > a1 char(10) 
   > )location('hdfs://node73:8020/user/testdb73/external_file/type_parquet/char1')
   > FORMAT 'parquet';
0 rows affected
SQL> 
SQL> -- 返回10个字符
SQL> select * from t_external_ldbdist_csv_char_002;
+------------+
| A1         |
+------------+
| KOWjsLYXdn |
+------------+
1 row selected.
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_char_003(
   > a1 char(30),
   > a2 char(30),
   > a3 char(30),
   > a4 char(30)
   > a5 char(30)
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/char1') FORMAT 'parquet';
java.sql.SQLSyntaxErrorException: unexpected token: A5 : line: 6 in statement [CREATE EXTERNAL TABLE t_external_hdfs_parquet_char_003(
a1 char(30),
a2 char(30),
a3 char(30),
a4 char(30)
a5 char(30)
)
LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/char1') FORMAT 'parquet']
SQL> select * from t_external_hdfs_parquet_char_003;
java.sql.SQLSyntaxErrorException: user lacks privilege or object not found: T_EXTERNAL_HDFS_PARQUET_CHAR_003 in statement [select * from t_external_hdfs_parquet_char_003]
SQL> 
SQL> 
SQL> -- 测试varchar，date,timestamp,boolean以及''等异常值
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_char_004(
   > a1 char(30),
   > a2 char(30),
   > a3 char(30),
   > a4 char(30),
   > a5 char(30),
   > a6 char(30),
   > a7 char(30),
   > a8 char(30),
   > a9 char(30),
   > a10 char(30),
   > a11 char(30),
   > a12 char(30),
   > a13 char(30)
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/common1') FORMAT'parquet';
0 rows affected
SQL> select * from t_external_hdfs_parquet_char_004;
+--------------------------------+----------------------------------+----------------------------------+--------------------------------+---------------------------------+--------------------------------+--------------------------------+--------+--------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+
| A1                             | A2                               | A3                               | A4                             | A5                              | A6                             | A7                             | A8     | A9     | A10                            | A11                            | A12                            | A13                            |
+--------------------------------+----------------------------------+----------------------------------+--------------------------------+---------------------------------+--------------------------------+--------------------------------+--------+--------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+
| asdf                           | 你好                             | 你好asdf                         | #$%^                           | @#￥%……                         |                                |                                | <null> | <null> | 2020-05-08                     | 2020-05-08 12:19:01            | true                           | false                          |
+--------------------------------+----------------------------------+----------------------------------+--------------------------------+---------------------------------+--------------------------------+--------------------------------+--------+--------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+
1 row selected.
SQL> exit
Disconnected.
