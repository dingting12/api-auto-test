SQLCli Release 0.0.45
SQL> start timestamp/external_table_basic_type-timestamp.sql
SQL> loaddriver E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar com.datapps.linkoopdb.jdbc.JdbcDriver
driver file [E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar] does not exist.
SQL> connect admin/123456@jdbc:linkoopdb:tcp://192.168.1.73:9105/ldb
Database connected.
SQL> set echo on
SQL> 
SQL> 
SQL> --    Description: timestamp边界值测试,timestamp的数值范围是0001-01-01 00:00:00/9999-12-31 23:59:59
   > --    Date:         2020-05-28
   > --    Author:       丁婷
   > --    hdfs external csv格式
   > 
   > -- 删除t_external_hdfs_csv_timestamp_001表
SQL> drop table if exists t_external_hdfs_csv_timestamp_001;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_001，测试timestamp类型边界异常值0001-01-00 00:00:00
SQL> create external table t_external_hdfs_csv_timestamp_001(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_001的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_001;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_002表
SQL> drop table if exists t_external_hdfs_csv_timestamp_002;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_002，测试timestamp类型边界异常值10000-01-01 00:00:00
SQL> create external table t_external_hdfs_csv_timestamp_002(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_002.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_002的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_002;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_003表
SQL> drop table if exists t_external_hdfs_csv_timestamp_003;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_003，测试int类型，值为1234567
SQL> create external table t_external_hdfs_csv_timestamp_003(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_003的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_003;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_004表
SQL> drop table if exists t_external_hdfs_csv_timestamp_004;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_004，测试double类型，值为54775807.111
SQL> create external table t_external_hdfs_csv_timestamp_004(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_004.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_004的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_004;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_005表
SQL> drop table if exists t_external_hdfs_csv_timestamp_005;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_005，测试varchar类型数字，值为'9223372036'
SQL> create external table t_external_hdfs_csv_timestamp_005(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_005的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_005;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_006表
SQL> drop table if exists t_external_hdfs_csv_timestamp_006;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_006，测试varchar英文字母，值为'asdf'
SQL> create external table t_external_hdfs_csv_timestamp_006(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzimu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_006的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_006;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_007表
SQL> drop table if exists t_external_hdfs_csv_timestamp_007;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_007，测试varchar中文字符，值为'你好'
SQL> create external table t_external_hdfs_csv_timestamp_007(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_007的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_007;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_008表
SQL> drop table if exists t_external_hdfs_csv_timestamp_008;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_008，测试varchar中英文字符，值为'你好asdf'
SQL> create external table t_external_hdfs_csv_timestamp_008(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_008的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_008;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_009表
SQL> drop table if exists t_external_hdfs_csv_timestamp_009;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_009，测试varchar英文特殊字符，值为'#$%^'
SQL> create external table t_external_hdfs_csv_timestamp_009(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_009的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_009;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_010表
SQL> drop table if exists t_external_hdfs_csv_timestamp_010;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_010，测试varchar中文特殊字符，值为'@#￥%……'
SQL> create external table t_external_hdfs_csv_timestamp_010(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_010的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_010;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_012，测试date类型，时间为2020-01-01
SQL> create external table t_external_hdfs_csv_timestamp_012(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_006.csv')
   > format 'csv' (delimiter ',');
java.sql.SQLSyntaxErrorException: object name already exists: T_EXTERNAL_HDFS_CSV_TIMESTAMP_012 in statement [create external table t_external_hdfs_csv_timestamp_012(
a1 timestamp  
)location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_006.csv')
format 'csv' (delimiter ',')]
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_012的数据,结果为2020-01-01 00:00:00
SQL> select * from t_external_hdfs_csv_timestamp_012;
+---------------------+
| A1                  |
+---------------------+
| 2020-01-01 00:00:00 |
+---------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_013表
SQL> drop table if exists t_external_hdfs_csv_timestamp_013;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_013，测试boolean类型的true 
SQL> create external table t_external_hdfs_csv_timestamp_013(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_013的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_013;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_014表
SQL> drop table if exists t_external_hdfs_csv_timestamp_014;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_014，测试boolean类型的false 
SQL> create external table t_external_hdfs_csv_timestamp_014(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_014的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_014;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_015表
SQL> drop table if exists t_external_hdfs_csv_timestamp_015;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_015，测试空值
SQL> create external table t_external_hdfs_csv_timestamp_015(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_015的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_015;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL>  
SQL>  
SQL> -- 删除t_external_hdfs_csv_timestamp_016表
SQL> drop table if exists t_external_hdfs_csv_timestamp_016;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_016，测试空格 
SQL> create external table t_external_hdfs_csv_timestamp_016(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_016的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_016;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_017表
SQL> drop table if exists t_external_hdfs_csv_timestamp_017;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_017，测试null 
SQL> create external table t_external_hdfs_csv_timestamp_017(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_017的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_017;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_018表
SQL> drop table if exists t_external_hdfs_csv_timestamp_018;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_018，测试NULL  
SQL> create external table t_external_hdfs_csv_timestamp_018(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_018的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_018;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_019表
SQL> drop table if exists t_external_hdfs_csv_timestamp_019;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_019，测试日期格式为YYYYMMDD HH24:MI:SS，值为20200101 12:01:01  
SQL> create external table t_external_hdfs_csv_timestamp_019(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_007.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_020的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_019;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_020表
SQL> drop table if exists t_external_hdfs_csv_timestamp_020;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_020，测试日期格式为YYYY/MM/DD HH24:MI:SS，值为2020/01/01 12:01:01  
SQL> create external table t_external_hdfs_csv_timestamp_020(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_008.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_020的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_020;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_hdfs_csv_timestamp_021表
SQL> drop table if exists t_external_hdfs_csv_timestamp_021;
0 rows affected
SQL> 
SQL> -- 创建表t_external_hdfs_csv_timestamp_021，测试日期格式为YYYY/MM/DD HH24:MI:SS，值为2020/01/01 12:01:01:01  
SQL> create external table t_external_hdfs_csv_timestamp_021(
   > a1 timestamp  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/timestamp_009.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_hdfs_csv_timestamp_021的数据,实际结果是返回空值
SQL> select * from t_external_hdfs_csv_timestamp_021;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> -- external ldbdist csv
   > -- 删除t_external_ldbdist_csv_timestamp_001表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_001;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_001，测试timestamp类型边界异常值0001-01-00 00:00:00
SQL> create external table t_external_ldbdist_csv_timestamp_001(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_001的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_001;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_002表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_002;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_002，测试timestamp类型边界异常值10000-01-01 00:00:00
SQL> create external table t_external_ldbdist_csv_timestamp_002(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_002.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_002的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_002;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_003表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_003;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_003，测试int类型，值为1234567
SQL> create external table t_external_ldbdist_csv_timestamp_003(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_003的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_003;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_004表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_004;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_004，测试double类型，值为54775807.111
SQL> create external table t_external_ldbdist_csv_timestamp_004(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_004.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_004的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_004;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_005表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_005;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_005，测试varchar类型数字，值为'9223372036'
SQL> create external table t_external_ldbdist_csv_timestamp_005(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_005的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_005;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_006表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_006;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_006，测试varchar英文字母，值为'asdf'
SQL> create external table t_external_ldbdist_csv_timestamp_006(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/varchar_yingwenzimu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_006的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_006;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_007表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_007;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_007，测试varchar中文字符，值为'你好'
SQL> create external table t_external_ldbdist_csv_timestamp_007(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_007的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_007;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_008表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_008;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_008，测试varchar中英文字符，值为'你好asdf'
SQL> create external table t_external_ldbdist_csv_timestamp_008(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_008的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_008;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_009表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_009;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_009，测试varchar英文特殊字符，值为'#$%^'
SQL> create external table t_external_ldbdist_csv_timestamp_009(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_009的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_009;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_010表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_010;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_010，测试varchar中文特殊字符，值为'@#￥%……'
SQL> create external table t_external_ldbdist_csv_timestamp_010(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_010的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_010;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_012，测试date类型，时间为2020-01-01
SQL> create external table t_external_ldbdist_csv_timestamp_012(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_006.csv')
   > format 'csv' (delimiter ',');
java.sql.SQLSyntaxErrorException: object name already exists: T_EXTERNAL_LDBDIST_CSV_TIMESTAMP_012 in statement [create external table t_external_ldbdist_csv_timestamp_012(
a1 timestamp  
)location('ldbdist://node74:54321/csv/timestamp_006.csv')
format 'csv' (delimiter ',')]
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_012的数据,结果为2020-01-01 00:00:00
SQL> select * from t_external_ldbdist_csv_timestamp_012;
+---------------------+
| A1                  |
+---------------------+
| 2020-01-01 00:00:00 |
+---------------------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_013表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_013;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_013，测试boolean类型的true 
SQL> create external table t_external_ldbdist_csv_timestamp_013(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_013的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_013;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_014表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_014;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_014，测试boolean类型的false 
SQL> create external table t_external_ldbdist_csv_timestamp_014(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_014的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_014;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_015表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_015;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_015，测试空值
SQL> create external table t_external_ldbdist_csv_timestamp_015(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_015的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_015;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL>  
SQL>  
SQL> -- 删除t_external_ldbdist_csv_timestamp_016表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_016;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_016，测试空格 
SQL> create external table t_external_ldbdist_csv_timestamp_016(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_016的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_016;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_017表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_017;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_017，测试null 
SQL> create external table t_external_ldbdist_csv_timestamp_017(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_017的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_017;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_018表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_018;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_018，测试NULL  
SQL> create external table t_external_ldbdist_csv_timestamp_018(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_018的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_018;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_019表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_019;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_019，测试日期格式为YYYYMMDD HH24:MI:SS，值为20200101 12:01:01  
SQL> create external table t_external_ldbdist_csv_timestamp_019(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_007.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_020的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_019;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_020表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_020;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_020，测试日期格式为YYYY/MM/DD HH24:MI:SS，值为2020/01/01 12:01:01  
SQL> create external table t_external_ldbdist_csv_timestamp_020(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_008.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_020的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_020;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 删除t_external_ldbdist_csv_timestamp_021表
SQL> drop table if exists t_external_ldbdist_csv_timestamp_021;
0 rows affected
SQL> 
SQL> -- 创建表t_external_ldbdist_csv_timestamp_021，测试日期格式为YYYY/MM/DD HH24:MI:SS，值为2020/01/01 12:01:01:01  
SQL> create external table t_external_ldbdist_csv_timestamp_021(
   > a1 timestamp  
   > )location('ldbdist://node74:54321/csv/timestamp_009.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL>   
SQL> --查询t_external_ldbdist_csv_timestamp_021的数据,实际结果是返回空值
SQL> select * from t_external_ldbdist_csv_timestamp_021;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- hdfs external parquet 
   > 
   > -- 删除表
SQL> drop table if exists t_external_hdfs_parquet_timestamp_001;
0 rows affected
SQL> drop table if exists t_external_hdfs_parquet_timestamp_002;
0 rows affected
SQL> 
SQL> -- 测试varchar，date,timestamp,boolean以及''等异常值
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_timestamp_001(
   > a1 timestamp,
   > a2 timestamp,
   > a3 timestamp,
   > a4 timestamp,
   > a5 timestamp,
   > a6 timestamp,
   > a7 timestamp,
   > a8 timestamp
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/timestamp1') FORMAT'parquet';
0 rows affected
SQL> select * from t_external_hdfs_parquet_timestamp_001;
+--------+--------+---------------------+----------------------------+--------+--------+--------+--------+
| A1     | A2     | A3                  | A4                         | A5     | A6     | A7     | A8     |
+--------+--------+---------------------+----------------------------+--------+--------+--------+--------+
| <null> | <null> | 1970-01-15 14:56:07 | 1971-09-27 07:30:07.111000 | <null> | <null> | <null> | <null> |
+--------+--------+---------------------+----------------------------+--------+--------+--------+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- 测试varchar，date,timestamp,boolean以及''等异常值
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_timestamp_002(
   > a1 timestamp,
   > a2 timestamp,
   > a3 timestamp,
   > a4 timestamp,
   > a5 timestamp,
   > a6 timestamp,
   > a7 timestamp,
   > a8 timestamp,
   > a9 timestamp,
   > a10 timestamp,
   > a11 timestamp,
   > a12 timestamp,
   > a13 timestamp
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/common1') FORMAT'parquet';
0 rows affected
SQL> select * from t_external_hdfs_parquet_timestamp_002;
+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------------------+---------------------+---------------------+---------------------+
| A1     | A2     | A3     | A4     | A5     | A6     | A7     | A8     | A9     | A10                 | A11                 | A12                 | A13                 |
+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------------------+---------------------+---------------------+---------------------+
| <null> | <null> | <null> | <null> | <null> | <null> | <null> | <null> | <null> | 2020-05-08 00:00:00 | 2020-05-08 12:19:01 | 1970-01-01 08:00:00 | 1970-01-01 08:00:00 |
+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------------------+---------------------+---------------------+---------------------+
1 row selected.
SQL> exit
Disconnected.
