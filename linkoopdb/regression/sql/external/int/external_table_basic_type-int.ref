SQLCli Release 0.0.45
SQL> start int/external_table_basic_type-int.sql
SQL> loaddriver E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar com.datapps.linkoopdb.jdbc.JdbcDriver
driver file [E:\pycharmProject\driver\linkoopdb-jdbc-2.2.2.jar] does not exist.
SQL> connect admin/123456@jdbc:linkoopdb:tcp://192.168.1.73:9105/ldb
Database connected.
SQL> set echo on
SQL> 
SQL> 
SQL> --    Description: int边界值测试,int的数值范围是-2,147,483,648/2,147,483,647
   > --    Date:         2020-05-28
   > --    Author:       丁婷
   > --    hdfs external csv格式
   > 
   > -- 测试int类型异常值-2147483649,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_001;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_001(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_001;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试samllint类型异常值2147483648,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_002;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_002(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_002.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_002;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试超出int范围的double类型,数据为2147483648.01,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_003;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_003(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_003;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试超出int范围的varchar类型数字，值为'2147483648',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_005;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_005(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_005;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- 测试varchar英文字母，值为'asdf',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_006;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_006(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzimu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_006;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中文字符，值为'你好',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_007;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_007(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_007;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中英文字符，值为'你好asdf',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_008;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_008(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_008;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar英文特殊字符，值为'#$%^',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_009;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_009(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_009;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中文特殊字符，值为'@#￥%……',实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_010;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_010(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_010;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- 测试测试date类型，值为2020-05-08,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_011;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_011(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_date.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_011;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试timestamp类型，值为2020-05-08 12:19:01,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_012;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_012(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_timestamp.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_012;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> --测试boolean类型的true ,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_013;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_013(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_013;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试boolean类型的false ,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_014;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_014(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_014;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL>  
SQL> -- 测试空值,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_015;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_015(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_015;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL>  
SQL>  
SQL> -- 测试空格 ,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_016;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_016(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_016;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试null ,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_017;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_017(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_017;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试NULL  ,实际结果是返回空值
SQL> drop table if exists t_external_hdfs_csv_int_018;
0 rows affected
SQL> create external table t_external_hdfs_csv_int_018(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_hdfs_csv_int_018;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- ldbdist csv格式
   > -- 测试int类型异常值-2147483649,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_001;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_001(
   > a1 int  
   > )location('ldbdist://node74:54321/csv/int_001.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_001;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试samllint类型异常值2147483648,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_002;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_002(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_002.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_002;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试超出int范围的double类型,数据为2147483648.01,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_003;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_003(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_003.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_003;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试超出int范围的varchar类型数字，值为'2147483648',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_005;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_005(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/int_005.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_005;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- 测试varchar英文字母，值为'asdf',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_006;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_006(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzimu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_006;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中文字符，值为'你好',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_007;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_007(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwen.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_007;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中英文字符，值为'你好asdf',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_008;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_008(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongyinghunhe.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_008;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar英文特殊字符，值为'#$%^',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_009;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_009(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_yingwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_009;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试varchar中文特殊字符，值为'@#￥%……',实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_010;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_010(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/varchar_zhongwenzifu.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_010;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> 
SQL> -- 测试测试date类型，值为2020-05-08,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_011;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_011(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_date.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_011;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试timestamp类型，值为2020-05-08 12:19:01,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_012;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_012(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_timestamp.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_012;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> --测试boolean类型的true ,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_013;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_013(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_true.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_013;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试boolean类型的false ,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_014;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_014(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/boolean_false.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_014;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL>  
SQL> -- 测试空值,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_015;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_015(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongzhi.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_015;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL>  
SQL>  
SQL> -- 测试空格 ,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_016;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_016(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_kongge.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_016;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试null ,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_017;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_017(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_null.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_017;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试NULL  ,实际结果是返回空值
SQL> drop table if exists t_external_ldbdist_csv_int_018;
0 rows affected
SQL> create external table t_external_ldbdist_csv_int_018(
   > a1 int  
   > )location('hdfs://node73:8020/user/testdb73/external_file/csv_type/type_NULL.csv')
   > format 'csv' (delimiter ',');
0 rows affected
SQL> select * from t_external_ldbdist_csv_int_018;
+--------+
| A1     |
+--------+
| <null> |
+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- hdfs external parquet 
   > 
   > -- 测试smallint边界值±1，超过smallint范围的double,以及超出smallint范围的varchar类型数字
SQL> drop table if exists t_external_hdfs_parquet_int_001;
0 rows affected
SQL> drop table if exists t_external_hdfs_parquet_int_002;
0 rows affected
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_int_001(
   > a1 int,
   > a2 int,
   > a3 int,
   > a4 int
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/int1') FORMAT'parquet';
0 rows affected
SQL> select * from t_external_hdfs_parquet_int_001;
+------------+-------------+------------+--------+
| A1         | A2          | A3         | A4     |
+------------+-------------+------------+--------+
| 2147483647 | -2147483648 | 2147483647 | <null> |
+------------+-------------+------------+--------+
1 row selected.
SQL> 
SQL> 
SQL> -- 测试smallint的varchar，date,timestamp,boolean以及''等异常值
SQL> CREATE EXTERNAL TABLE t_external_hdfs_parquet_int_002(
   > a1 int,
   > a2 int,
   > a3 int,
   > a4 int,
   > a5 int,
   > a6 int,
   > a7 int,
   > a8 int,
   > a9 int,
   > a10 int,
   > a11 int,
   > a12 int,
   > a13 int
   > )
   > LOCATION ('hdfs://node73:8020/user/testdb73/external_file/type_parquet/common1') FORMAT'parquet';
0 rows affected
SQL> select * from t_external_hdfs_parquet_int_002;
+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+------------+-----+-----+
| A1     | A2     | A3     | A4     | A5     | A6     | A7     | A8     | A9     | A10    | A11        | A12 | A13 |
+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+------------+-----+-----+
| <null> | <null> | <null> | <null> | <null> | <null> | <null> | <null> | <null> | <null> | 1588911541 | 1   | 0   |
+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+------------+-----+-----+
1 row selected.
SQL> exit
Disconnected.
