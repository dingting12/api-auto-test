--    Description: 测试pallas dblink
--    Date:         2020-07-01
--    Author:       丁婷

set echo on

DROP SCHEMA S_PALLAS_SCHEMA_003 IF EXISTS CASCADE;

CREATE SCHEMA S_PALLAS_SCHEMA_003 engine pallas;

DROP DATABASE link LINK_ORACLE_PALLAS_001 IF EXISTS CASCADE;

CREATE DATABASE LINK LINK_ORACLE_PALLAS_001 CONNECT TO 'linkoopdb' IDENTIFIED BY '123456' USING 'jdbc:oracle:thin:@192.168.1.72:1521:xe' properties ('maxActive':'5');

DROP table LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001 IF EXISTS CASCADE;

CREATE TABLE LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001(
id INT,
name VARCHAR(200),
sal NUMERIC(10,2)
);

INSERT INTO LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001 VALUES
(1,'qqq',122.323),
(2,'www',344.454),
(3,'cnkh',349854.545);

show CREATE TABLE LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001;

SELECT * FROM LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001 ORDER BY id;


DROP TABLE S_PALLAS_SCHEMA_003.T_LINK_PALLAS_002 IF EXISTS CASCADE;

CREATE TABLE S_PALLAS_SCHEMA_003.T_LINK_PALLAS_002 AS 
(SELECT * FROM LINK_ORACLE_PALLAS_001.T_LINK_PALLAS_001) WITH DATA;

show CREATE TABLE S_PALLAS_SCHEMA_003.T_LINK_PALLAS_002;

SELECT * FROM S_PALLAS_SCHEMA_003.T_LINK_PALLAS_002 ORDER BY id;