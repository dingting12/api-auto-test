--    Description: 测试Primary index for pallas table
--    Date:         2020-06-30
--    Author:       丁婷

set echo on

-- 测试单个主键带upsert,upsert为true
DROP TABLE T_PALLAS_UPSERT_001 IF EXISTS CASCADE; 
 
CREATE TABLE T_PALLAS_UPSERT_001(
   id INT PRIMARY KEY,
   name VARCHAR(50),
   sal NUMERIC(10,2),
   deptid INT,
   birthdate DATE
 )properties ('upsert':'true')engine pallas;

INSERT INTO T_PALLAS_UPSERT_001 VALUES
(1,'cd',2301.2,10,DATE '1990-01-23'),
(2,'qwr',3610.35,20,DATE '1991-03-09'),
(3,'ciy',1000.00,30,DATE '1992-10-06'),
(4,'hhh',85263.23,40,DATE '1993-12-30');
	   
SELECT * FROM T_PALLAS_UPSERT_001 ORDER BY id,name;	 

INSERT INTO T_PALLAS_UPSERT_001 VALUES(1,'wowow',500.09,50,DATE '1800-01-01');  

INSERT INTO T_PALLAS_UPSERT_001 VALUES(10,'owni',2389.23,100,DATE '1983-01-01');

select * from T_PALLAS_UPSERT_001;

UPDATE T_PALLAS_UPSERT_001
SET id=13,name='qoqo'
WHERE id=3;

select * from T_PALLAS_UPSERT_001;

DROP TABLE T_PALLAS_UPSERT_001 IF EXISTS CASCADE;



-- 测试单个主键带upsert,upsert为false
DROP TABLE T_PALLAS_UPSERT_002 IF EXISTS CASCADE;

CREATE TABLE T_PALLAS_UPSERT_002(
   id INT PRIMARY KEY,
   name VARCHAR(50),
   sal NUMERIC(10,2),
   deptid INT,
   birthdate DATE
 )properties ('upsert':'false')engine pallas;

INSERT INTO T_PALLAS_UPSERT_002 VALUES
(1,'cd',2301.2,10,DATE '1990-01-23'),
(2,'qwr',3610.35,20,DATE '1991-03-09'),
(3,'ciy',1000.00,30,DATE '1992-10-06'),
(4,'hhh',85263.23,40,DATE '1993-12-30');
	   
SELECT * FROM T_PALLAS_UPSERT_002 ORDER BY id,name;	 

INSERT INTO T_PALLAS_UPSERT_002 VALUES(1,'wowow',500.09,50,DATE '1800-01-01');  

INSERT INTO T_PALLAS_UPSERT_002 VALUES(10,'owni',2389.23,100,DATE '1983-01-01');

select * from T_PALLAS_UPSERT_002;

DROP TABLE T_PALLAS_UPSERT_002 IF EXISTS CASCADE;



-- 测试多个主键带upsert,upsert为true
DROP TABLE T_PALLAS_UPSERT_003 IF EXISTS CASCADE; 
 
CREATE TABLE T_PALLAS_UPSERT_003(
   id INT,
   name VARCHAR(50),
   sal NUMERIC(10,2),
   deptid INT,
   birthdate DATE,
   PRIMARY KEY(id,name)
 )properties ('upsert':'true')engine pallas;

INSERT INTO T_PALLAS_UPSERT_003 VALUES
(1,'cd',2301.2,10,DATE '1990-01-23'),
(2,'qwr',3610.35,20,DATE '1991-03-09'),
(3,'ciy',1000.00,30,DATE '1992-10-06'),
(4,'hhh',85263.23,40,DATE '1993-12-30');
	   
SELECT * FROM T_PALLAS_UPSERT_003 ORDER BY id,name;	 

INSERT INTO T_PALLAS_UPSERT_003 VALUES(1,'wowow',500.09,50,DATE '1800-01-01');  

INSERT INTO T_PALLAS_UPSERT_003 VALUES(2,'qwr',2389.23,100,DATE '1983-01-01');

select * from T_PALLAS_UPSERT_003;

UPDATE T_PALLAS_UPSERT_003
SET id=13,name='qoqo'
WHERE id=3;

select * from T_PALLAS_UPSERT_003;

DROP TABLE T_PALLAS_UPSERT_003 IF EXISTS CASCADE;



-- 测试多个主键带upsert,upsert为false
DROP TABLE T_PALLAS_UPSERT_004 IF EXISTS CASCADE;

CREATE TABLE T_PALLAS_UPSERT_004(
   id INT PRIMARY KEY,
   name VARCHAR(50),
   sal NUMERIC(10,2),
   deptid INT,
   birthdate DATE,
   PRIMARY KEY(id,name)
 )properties ('upsert':'false')engine pallas;

INSERT INTO T_PALLAS_UPSERT_004 VALUES
(1,'cd',2301.2,10,DATE '1990-01-23'),
(2,'qwr',3610.35,20,DATE '1991-03-09'),
(3,'ciy',1000.00,30,DATE '1992-10-06'),
(4,'hhh',85263.23,40,DATE '1993-12-30');
	   
SELECT * FROM T_PALLAS_UPSERT_004 ORDER BY id,name;	 

INSERT INTO T_PALLAS_UPSERT_004 VALUES(1,'wowow',500.09,50,DATE '1800-01-01');  

INSERT INTO T_PALLAS_UPSERT_004 VALUES(2,'qwr',2389.23,100,DATE '1983-01-01');

select * from T_PALLAS_UPSERT_004;

DROP TABLE T_PALLAS_UPSERT_004 IF EXISTS CASCADE;


