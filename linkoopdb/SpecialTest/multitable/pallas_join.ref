SQLCli Release 0.0.52
SQL> start pallas_join.sql
SQL> --Description:join
   > --Date：2020-05-08
   > --Author：贾路遥
SQL> connect admin/123456
Database connected.
SQL> set timing on
Running time elapsed:      0.00 Seconds
SQL> set ECHO ON
Running time elapsed:      0.00 Seconds
SQL> set WHENEVER_SQLERROR CONTINUE
Running time elapsed:      0.00 Seconds
SQL> set termout off
Running time elapsed:      0.00 Seconds
SQL> 
SQL> 
SQL> 
SQL> --以下为两表进行inner join的测试用例
   > --单个等值join
   > --两表join,单个等值join,join字段类型为BIGINT
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TUNIQUE=B.TUNIQUE   limit 100;
100 rows selected.
Running time elapsed:     99.35 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TDOUBLE=B.TDOUBLE  limit 100;
100 rows selected.
Running time elapsed:     14.66 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为DATE
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TDATE=B.TDATE  limit 100;
100 rows selected.
Running time elapsed:     14.06 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TVARCHAR=B.TVARCHAR  limit 100;
100 rows selected.
Running time elapsed:     15.66 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为SMALLINT
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TSMALLINT=B.TSMALLINT  limit 100;
100 rows selected.
Running time elapsed:     17.07 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为INTEGER
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TINTEGER=B.TINTEGER  limit 100;
100 rows selected.
Running time elapsed:     13.93 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为REAL
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TREAL=B.TREAL  limit 100;
100 rows selected.
Running time elapsed:     14.22 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为TFLOAT
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TFLOAT=B.TFLOAT  limit 100;
100 rows selected.
Running time elapsed:     19.89 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为DECIMAL
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TDECIMAL=B.TDECIMAL  limit 100;
100 rows selected.
Running time elapsed:     14.51 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为NUMERIC
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TNUMERIC=B.TNUMERIC  limit 100;
100 rows selected.
Running time elapsed:     15.51 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为TIMESTAMP
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TTIMESTAMP=B.TTIMESTAMP  limit 100;
100 rows selected.
Running time elapsed:     16.12 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为BOOLEAN
   > --SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TBOOL=B.TBOOL  limit 100;
   > 
   > --两表join,单个等值join,join字段类型为CHAR
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TCHAR=B.TCHAR  limit 100;
100 rows selected.
Running time elapsed:     19.34 Seconds
SQL> 
SQL> --两表join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TVARCHAR=B.TVARCHAR  limit 100;
100 rows selected.
Running time elapsed:     14.62 Seconds
SQL> 
SQL> --多个等值join
   > --两表join,多个等值join组合,无过滤条件，包含DDL中所有字段,字段类型包含BIGINT,SMALLINT,INTEGER,REAL,DOUBLE,FLOAT,DECIMAL,NUMERIC,DATE,TIMESTAMP,BOOLEAN,CHAR,VARCHAR
SQL> SELECT A.*,B.* 
   > 	FROM P1000 A 
   > 	JOIN P5000 B 
   > 	  ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT 
   > 	    AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 		AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3 limit 100;
0 rows selected.
Running time elapsed:     28.30 Seconds
SQL> 	
SQL> --两表join,多个等值join组合,3条过滤条件，过滤条件类型包括smallint,boolean,varchar,包含DDL中所有字段,字段类型包含BIGINT,SMALLINT,INTEGER,REAL,DOUBLE,FLOAT,DECIMAL,NUMERIC,DATE,TIMESTAMP,BOOLEAN,CHAR,VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A 
   > 	JOIN P5000 B 
   > 	  ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 		AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 		AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3
   > 	WHERE A.TSMALLINT BETWEEN 1 AND 1000
   > 	  AND B.TBOOL=TRUE
   > 	  AND A.TVARCHARIDX2 LIKE '%A%' limit 100;
0 rows selected.
Running time elapsed:     11.34 Seconds
SQL> 
SQL> 
SQL> 
SQL> --显式隐式转换
   > 
   > --两表join,单个等值join,显式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TINTEGER=cast(B.TDOUBLE AS int) limit 100;
100 rows selected.
Running time elapsed:     20.41 Seconds
SQL> 
SQL> --两表join,单个等值join,隐式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TINTEGER=B.TDOUBLE limit 100;
100 rows selected.
Running time elapsed:     20.12 Seconds
SQL> 
SQL> --两表join,显式隐式转换组合,TIMESTAMP&DATE
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) limit 100;
0 rows selected.
Running time elapsed:     24.95 Seconds
SQL> 
SQL> --两表join,多个等值join组合&显式隐式转换组合，4个条件
SQL> SELECT A.*,B.* FROM P1000 A JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) AND A.TDECIMAL=B.TDECIMAL AND A.TBOOL=B.TBOOL limit 100;
0 rows selected.
Running time elapsed:     21.64 Seconds
SQL> 
SQL> --以下为left join测试用例	
   > --单个等值join 
   > --out join,两表left join,单个等值join,join字段类型为BIGINT
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TUNIQUE=B.TUNIQUE limit 100;
100 rows selected.
Running time elapsed:     20.68 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TDOUBLE=B.TDOUBLE limit 100;
100 rows selected.
Running time elapsed:     12.23 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为DATE
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TDATE=B.TDATE limit 100;
100 rows selected.
Running time elapsed:     12.95 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TVARCHAR=B.TVARCHAR limit 100;
100 rows selected.
Running time elapsed:     20.84 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为SMALLINT
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TSMALLINT=B.TSMALLINT limit 100;
100 rows selected.
Running time elapsed:     12.63 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为INTEGER
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TINTEGER=B.TINTEGER limit 100;
100 rows selected.
Running time elapsed:     16.23 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为REAL
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TREAL=B.TREAL limit 100;
100 rows selected.
Running time elapsed:     16.69 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为TFLOAT
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TFLOAT=B.TFLOAT limit 100;
100 rows selected.
Running time elapsed:     12.71 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为DECIMAL
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TDECIMAL=B.TDECIMAL limit 100;
100 rows selected.
Running time elapsed:     13.27 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为NUMERIC
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TNUMERIC=B.TNUMERIC limit 100;
100 rows selected.
Running time elapsed:     12.18 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为TIMESTAMP
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TTIMESTAMP=B.TTIMESTAMP limit 100;
100 rows selected.
Running time elapsed:     24.06 Seconds
SQL> 
SQL> --out join,两表left join,单个等值join,join字段类型为BOOLEAN
   > --SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TBOOL=B.TBOOL limit 100;
   > 
   > --out join,两表left join,单个等值join,join字段类型为CHAR
SQL> SELECT A.*,B.* FROM P1000 A left join P5000 B ON A.TCHAR=B.TCHAR limit 100;
100 rows selected.
Running time elapsed:     12.33 Seconds
SQL> 
SQL> 
SQL> --多个等值join
   > --out join,两表left join,多个等值join组合,包含DDL中所有字段
SQL> SELECT A.*,B.* FROM P1000 A LEFT JOIN P5000 B ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 	AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 	AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3  limit 100;
100 rows selected.
Running time elapsed:     13.21 Seconds
SQL> 
SQL> --out join,两表left join,3条过滤条件，多个等值join组合，过滤条件类型包括numeric,int,float,包含DDL中所有字段
SQL> SELECT A.*,B.* FROM P1000 A 
   > 	LEFT JOIN P5000 B 
   > 	  ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 	  AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 	  AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3
   > 	WHERE A.TNUMERIC NOT IN (6394.4060,6113.0566,7135.5794)
   > 	  AND B.TINTEGER > 37843778
   > 	  AND ((A.TFLOAT BETWEEN 1337.4699707031 AND 6847.7001953125) OR (A.TFLOAT BETWEEN 526.4699707031 AND 632.9600219727))
   > 	   limit 100;
0 rows selected.
Running time elapsed:     20.20 Seconds
SQL> 
SQL> --显式隐式转换
   > --out join,两表left join,单个等值join,显式转换类型,INTEGER&DOUBLE	
SQL> SELECT A.*,B.* FROM P1000 A LEFT JOIN P5000 B ON A.TINTEGER=cast(B.TDOUBLE AS int) limit 100;
100 rows selected.
Running time elapsed:     14.21 Seconds
SQL> --out join,两表left JOIN,单个等值join,隐式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A LEFT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE limit 100;
100 rows selected.
Running time elapsed:     13.21 Seconds
SQL> --out join,两表left JOIN,显式隐式转换组合,TIMESTAMP&DATE
SQL> SELECT A.*,B.* FROM P1000 A LEFT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) limit 100;
100 rows selected.
Running time elapsed:     12.56 Seconds
SQL> --out join,两表left JOIN,多个等值join组合&显式隐式转换组合，4个条件
SQL> SELECT A.*,B.* FROM P1000 A LEFT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) AND A.TDECIMAL=B.TDECIMAL AND A.TBOOL=B.TBOOL limit 100;
100 rows selected.
Running time elapsed:     20.56 Seconds
SQL> 
SQL> 
SQL> --以下为right join测试用例
   > --单个等值join
   > --out join,两表right join,单个等值join,join字段类型为BIGINT
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TUNIQUE=B.TUNIQUE limit 100;
100 rows selected.
Running time elapsed:     10.56 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TDOUBLE=B.TDOUBLE limit 100; 
100 rows selected.
Running time elapsed:      9.89 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为DATE
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TDATE=B.TDATE limit 100;
100 rows selected.
Running time elapsed:     10.81 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TVARCHAR=B.TVARCHAR limit 100;
100 rows selected.
Running time elapsed:     10.05 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为SMALLINT
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TSMALLINT=B.TSMALLINT limit 100;
100 rows selected.
Running time elapsed:      9.91 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为INTEGER
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TINTEGER=B.TINTEGER limit 100;
100 rows selected.
Running time elapsed:     10.61 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为REAL
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TREAL=B.TREAL limit 100;
100 rows selected.
Running time elapsed:     10.15 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为TFLOAT
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TFLOAT=B.TFLOAT limit 100;
100 rows selected.
Running time elapsed:     10.03 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为DECIMAL
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TDECIMAL=B.TDECIMAL limit 100;
100 rows selected.
Running time elapsed:     10.67 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为NUMERIC
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TNUMERIC=B.TNUMERIC limit 100;
100 rows selected.
Running time elapsed:      9.96 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为TIMESTAMP
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TTIMESTAMP=B.TTIMESTAMP limit 100;
100 rows selected.
Running time elapsed:      9.92 Seconds
SQL> 
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为CHAR
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TCHAR=B.TCHAR limit 100;
100 rows selected.
Running time elapsed:     13.44 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TVARCHAR=B.TVARCHAR limit 100;
100 rows selected.
Running time elapsed:      9.69 Seconds
SQL> 
SQL> --多个等值join
   > --out join,两表right join,多个等值join组合,包含DDL中所有字段
SQL> SELECT A.*,B.* FROM P1000 A right join P5000 B ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 	AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 	AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3
   > 	limit 100;
100 rows selected.
Running time elapsed:     10.13 Seconds
SQL> 
SQL> --out join,两表right join,4条过滤条件，过滤条件中的类型包含bigint,real,double,decimal,多个等值join组合,包含DDL中所有字段
SQL> SELECT A.*,B.* FROM P1000 A 
   > 	right join P5000 B 
   > 	  ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 		AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 		AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3
   > 	WHERE B.TUNIQUE > 100000
   > 	  AND A.TREAL NOT IN (214.57,2634.13,2862.67,1767.11)
   > 	  AND A.TDOUBLE <> 1703.51
   > 	  AND A.TDECIMAL > 5135.00
   > 	  limit 100;
0 rows selected.
Running time elapsed:     17.08 Seconds
SQL> 
SQL> --显式隐式转换
   > --out join,两表right join,单个等值join,显式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A RIGHT JOIN P5000 B ON A.TINTEGER=cast(B.TDOUBLE AS int) limit 100;
100 rows selected.
Running time elapsed:      9.95 Seconds
SQL> 
SQL> --out join,两表right join,单个等值join,隐式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A RIGHT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE limit 100;
100 rows selected.
Running time elapsed:     10.35 Seconds
SQL> 
SQL> --out join,两表right join,显式隐式转换组合,TIMESTAMP&DATE
SQL> SELECT A.*,B.* FROM P1000 A RIGHT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) limit 100;
100 rows selected.
Running time elapsed:     10.33 Seconds
SQL> 
SQL> --out join,两表right join,多个等值join组合&显式隐式转换组合，4个条件
SQL> SELECT A.*,B.* FROM P1000 A RIGHT JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) AND A.TDECIMAL=B.TDECIMAL AND A.TBOOL=B.TBOOL limit 100; 
100 rows selected.
Running time elapsed:     10.34 Seconds
SQL> 
SQL> 
SQL> --以下为full outer join测试用例
   > --out join,两表full outer join,单个等值join,join字段类型为BIGINT
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TUNIQUE=B.TUNIQUE limit 100;
100 rows selected.
Running time elapsed:     12.82 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TDOUBLE=B.TDOUBLE limit 100;
100 rows selected.
Running time elapsed:     16.75 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为DATE
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TDATE=B.TDATE limit 100;
100 rows selected.
Running time elapsed:     12.79 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为VARCHAR
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TVARCHAR=B.TVARCHAR limit 100;
100 rows selected.
Running time elapsed:     17.86 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为SMALLINT
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TSMALLINT=B.TSMALLINT limit 100;
100 rows selected.
Running time elapsed:     21.40 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为INTEGER
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TINTEGER=B.TINTEGER limit 100;
100 rows selected.
Running time elapsed:     13.36 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为REAL
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TREAL=B.TREAL limit 100;
100 rows selected.
Running time elapsed:     14.42 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为TFLOAT
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TFLOAT=B.TFLOAT limit 100;
100 rows selected.
Running time elapsed:     21.79 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为DECIMAL
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TDECIMAL=B.TDECIMAL limit 100;
100 rows selected.
Running time elapsed:     12.68 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为NUMERIC
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TNUMERIC=B.TNUMERIC limit 100;
100 rows selected.
Running time elapsed:     16.74 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为TIMESTAMP
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TTIMESTAMP=B.TTIMESTAMP limit 100;
100 rows selected.
Running time elapsed:     14.98 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,join字段类型为CHAR
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TCHAR=B.TCHAR limit 100;
100 rows selected.
Running time elapsed:     17.08 Seconds
SQL> 
SQL> 
SQL> --多个等值join
   > --out join,两表full outer join,多个等值join组合,包含DDL中所有字段
SQL> SELECT A.*,B.* FROM P1000 A full outer join P5000 B ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 	AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 	AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3 limit 100;
100 rows selected.
Running time elapsed:     12.96 Seconds
SQL> 
SQL> --out join,两表full outer join,2条过滤条件,过滤条件中包含timestamp和date类型，多个等值join组合,包含DDL中所有字段
SQL> SELECT A.*,B.* 
   > 	FROM P1000 A 
   > 	full outer join P5000 B 
   > 	  ON A.TUNIQUE=B.TUNIQUE AND A.TSMALLINT=B.TSMALLINT AND A.TINTEGER=B.TINTEGER AND A.TBIGINT=B.TBIGINT
   > 		AND A.TREAL=B.TREAL AND A.TDOUBLE=B.TDOUBLE AND A.TFLOAT=B.TFLOAT AND A.TDECIMAL=B.TDECIMAL AND A.TNUMERIC=B.TNUMERIC AND A.TDATE=B.TDATE AND A.TTIMESTAMP=B.TTIMESTAMP AND A.TBOOL=B.TBOOL AND A.TCHAR=B.TCHAR AND A.TVARCHAR=B.TVARCHAR
   > 		AND A.TCHARIDX1=B.TCHARIDX1 AND A.TCHARIDX2=B.TCHARIDX2 AND A.TCHARIDX3=B.TCHARIDX3 AND A.TVARCHARIDX1=B.TVARCHARIDX1 AND A.TVARCHARIDX2=B.TVARCHARIDX2 AND A.TVARCHARIDX3=B.TVARCHARIDX3
   > 	WHERE month(TIMESTAMP(A.TTIMESTAMP))=7
   > 		  AND  WEEKOFYEAR(A.TDATE)=8
   > 		  limit 100;
100 rows selected.
Running time elapsed:     15.98 Seconds
SQL> 				
SQL> --显式隐式转换
   > --out join,两表full outer join,单个等值join,显式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A FULL OUTER JOIN P5000 B ON A.TINTEGER=cast(B.TDOUBLE AS int)  limit 100;
100 rows selected.
Running time elapsed:     15.63 Seconds
SQL> 
SQL> --out join,两表full outer join,单个等值join,隐式转换类型,INTEGER&DOUBLE
SQL> SELECT A.*,B.* FROM P1000 A FULL OUTER JOIN P5000 B ON A.TINTEGER=B.TDOUBLE  limit 100;
100 rows selected.
Running time elapsed:     12.58 Seconds
SQL> 
SQL> --out join,两表full outer join,显式隐式转换组合,TIMESTAMP&DATE
SQL> SELECT A.*,B.* FROM P1000 A FULL OUTER JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) limit 100;
100 rows selected.
Running time elapsed:     16.23 Seconds
SQL> 
SQL> --out join,两表full outer join,多个等值join组合&显式隐式转换组合，4个条件
SQL> SELECT A.*,B.* FROM P1000 A FULL OUTER JOIN P5000 B ON A.TINTEGER=B.TDOUBLE AND A.TTIMESTAMP=cast(B.TDATE AS TIMESTAMP) AND A.TDECIMAL=B.TDECIMAL AND A.TBOOL=B.TBOOL limit 100;
100 rows selected.
Running time elapsed:     25.95 Seconds
SQL> 
SQL> 
SQL> --以下为并集的测试用例
   > --并集，两个表进行并集操作，包含所有的行
SQL> SELECT * FROM P1000
   > UNION ALL
   > SELECT * FROM P5000 limit 100;
100 rows selected.
Running time elapsed:      0.50 Seconds
SQL> 
SQL> --并集，两个表进行并集操作，包含所有的行,使用过滤条件,过滤条件包括date，smallint
SQL> SELECT * FROM P1000 A WHERE A.TDATE='2018-05-28'
   > UNION ALL
   > SELECT * FROM P5000 B WHERE B.TSMALLINT BETWEEN 0 AND 9090 limit 100;
100 rows selected.
Running time elapsed:      1.79 Seconds
SQL> 
SQL> --并集，两个表进行并集操作，删除重复的行
SQL> SELECT * FROM P1000 
   > UNION
   > SELECT * FROM P5000 limit 100;
100 rows selected.
Running time elapsed:     15.14 Seconds
SQL> 
SQL> --并集，两个表进行并集操作，删除重复的行,使用过滤条件,过滤条件包括date，smallint
SQL> SELECT * FROM P1000 A WHERE A.TDATE='2018-05-28'
   > UNION 
   > SELECT * FROM P5000 B WHERE B.TSMALLINT BETWEEN 0 AND 9090 limit 100;
100 rows selected.
Running time elapsed:     14.48 Seconds
SQL> 
SQL> --以下为交集的测试用例
   > --交集，两表进行交集操作
SQL> SELECT * FROM P1000 
   > INTERSECT
   > SELECT * FROM P5000 limit 100;
0 rows selected.
Running time elapsed:     26.24 Seconds
SQL> 
SQL> --交集，两个表进行交集操作，使用过滤条件,过滤条件包括date，smallint
SQL> SELECT * FROM P1000 A WHERE A.TDATE='2018-05-28'
   > INTERSECT
   > SELECT * FROM P5000 B WHERE B.TSMALLINT BETWEEN 0 AND 9090 limit 100;
0 rows selected.
Running time elapsed:     23.90 Seconds
Running time elapsed:   1275.12 Seconds
SQL> exit
Disconnected.
